---
title: "Duration of *must* in spoken American English"
author: "Susanne Flach"
date: "`r Sys.Date()`"
output: 
  html_document:
    theme: flatly
    code_folding: hide
    toc: yes
    toc_float:
      collapsed: true
editor_options: 
  chunk_output_type: console
  markdown: 
    wrap: 72
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, fig.width = 6, fig.height = 4)
```

## Background

This analysis came about almost by accident: at the time, we were working on English modal auxiliaries, trying to figure out what makes people distinguish between verbs of similar meaning such as *must* or *have to*. For another side project, I was exploring the potential of a new data source that provided word duration information.

So I put the two together: do the two meanings of English *must*, which differ by their lexical and syntactic environment, also **differ in phonetic properties, and if so, can we measure it, and if so still, would that help people distinguishing the two?**

(tl;dr, I found answers to the first two questions as discussed below. The third question turned out too complex to measure given the priorities of my main projects.)

These phonetic properties hadn't been studied for modals so far, probably due to lack of data. Differences wouldn't at all be surprising however. We know that homophones like *time* and *thyme* or verb vs. noun uses like *to snow* & *the snow* differ a lot. Usually it's the more frequent or more 'basic' meaning that is shorter.[^1]

[^1]: Gahl, Susanne. 2008. Time and thyme are not homophones: The effect of lemma frequency on word durations in spontaneous speech. Language 84(3). 474–496. https://doi.org/10.1353/lan.0.0035. Lohmann, Arne. 2018. Time and thyme are NOT homophones: A closer look at Gahl’s work on the lemma-frequency effect, including a reanalysis. Language 94(2). e180–e190. https://doi.org/10.1353/lan.2018.0032 

### The two meanings of *must*

The basics: English *must* has two meanings:

1. **Deontic**: what has to be done (*We <u>must</u> be vigilant*)
2. **Epistemic**: a situation that is probably the case (*He <u>must</u> be home; his car is in the driveway*).

The two meanings occur in very different lexico-grammatical environments. For example, if followed by a perfect (*That must <u>have been</u> difficult*), the meaning is nearly always epistemic, whereas if followed by a main verb (*We must <u>clean</u> up this mess*), the meaning is usually deontic. As linguistic environments are very reliable cues to the meaning, we must control for such factors to avoid attributing an effect to a factor of interest that are in fact just an artefact.

### The question(s)

**As mentioned, I was interested in whether the two meanings also differ in duration, which has theoretical implications for word storage or lexical change.**

In general, duration differences are usually due to:

* Frequency of use in general
* Frequency of co-occurrence with surrounding words
* Emphasis on words
* Speech rate: if a conversation is fast-paced, words will be spoken more quickly

The frequency properties are due to ease of articulation and expectation: more common words or words that often co-occur are more easily retrieved from memory. Hence, less effort is required in their articulation, leading to shorter duration. This has been shown for cases such as *time* vs. *thyme* or *but* vs. *butt*, where the former are vastly more common than the latter.

We measure frequency as the number of times a word occurs in large text collections (called 'corpus'). However, the two meanings of *must* are roughly equally frequent, and any differences depend on the composition of a corpus: deontic *must* is more likely in formal situations, while epistemic *must* is characteristic of informal and/or spoken-like discourse. In any case, their frequency differences are on the same order of magnitude where frequency effects are probably negligible.

As there was little research to go by in terms of hypotheses, I was mainly interested in an exploratory analysis:

* Do the two meanings differ in duration? If so, by how much?
* Are there more general phoentic differences between the two meanings?

## The data

For this kind of analysis, we need a fairly large corpus. This comes with the trade-off that measuring word duration must be automatic and is thus coarse-grained; also the audio quality of large data sets can be very low by traditional standards in phonetics.

Nevertheless, the NewsScape corpus is a very interesting resource this task ([see the RedHenLab for more info.](https://www.redhenlab.org/home)). The [NewsScape2016](https://multimodalcorpora.org/web/) corpus provides corpus-linguistically processed data from US Network television. Closed captions were force-aligned with the audio from which word duration can be determined in centiseconds.

I extracted the data via a CQL-based query. I picked the data points in two rounds: first, semi-manually from a list of 20,000 uses of *must* in NewsScape2016. The exact procedure and code will be provided at a later point, but basically I excluded tokens if they have substantial pauses before or after *must* or when no speech rate could be determined due to missing context or failed forced-alignment.

Second, I then manually checked ~2,000 examples against their original video using [RapidAnnotator](https://www.rapidannotator.org/). This served two purposes: (a) I removed unusable data such when the closed-caption did not read what was said, music, or disfluent utterances, and (b) a colleague and myself annotated each *must* use for meaning and whether the use carried particular emphasis. In a final step, I also calculated speechrate (using {nsyllable}) and transitional probabilities.

*Side note: the annotations of emphasis are solely based on the work by my colleague who was unaware of the purpose of the study at the time. We overall agreed, but he had slightly lower preferences to mark a use as emphasized.*

### Data preparation

```{r prelims}
# load libraries
library(tidyverse)
library(knitr)
library(extrafont)
library(see)
library(beeswarm)
library(ggstatsplot)
#loadfonts(device = "postscript")
theme_set(suzR::theme_suzR())

# set colors
PB = c(rgb(0, 102, 204, maxColorValue=255))
PG = c(rgb(153, 204, 0, maxColorValue=255))
```

### Variables

This snippet shows 10 random examples of data points to illustrate the data structure:

```{r data}
# load data
must <- readr::read_csv("https://raw.githubusercontent.com/skeptikantin/must_duration/main/data/must.csv")

## anc: undo the transformations
#head(must)

# inspect the data structure
set.seed(12345)
must |> 
  arrange(cpos) |> 
  select(l1, match, r1, meaning, emphasis, dur, sr, m_r1_tp_fw, m_r1_bgrm_frq) |> 
  # rename
  rename(duration = dur, speechrate = sr, trans_prop = m_r1_tp_fw, bgrm_freq = m_r1_bgrm_frq) |> 
  # random selection of 10 lines:
  sample_n(10) |> 
  kable(digits = 3, caption = "Must data: outcome(s) and predictors")
```

A brief description of the most important variables:

* `l1`, `match` and `r1`: *must* and the words to its left and right.
* `meaning`: indicate whether the use is epistemic or deontic.
* `emphasis` indicates if the *must* use occurred in a context of particular stress or emphasis.
* `duration` of *must* in 1/100th of a second (**c**enti**s**econds).
* `speechrate`: average number of syllables per second spoken 20 words before and 20 words after (a higher number points a more fast-paced speech situation.
* `trans_prob`: the transitional probability between *must* and the following word.

Transitional probability is a bit complicated, but basically: if a word follows *must* very often, the probability is high that speakers (and hearers) expect that word with a higher probability after they say (or hear) *must*. For example, *must* and *be* occur a lot together, hence, the transitional probability is very high (0.28). Or, in other words, 28% of *must* uses are followed by *be*.

*Transitional probability is `NA` where the word combination of *must *and the second word does not occur in the data base over which transitional probability was caluclated, which in this case was the Corpus of Contemporary American English.*

## Exploratory data analysis

### Duration & meaning

Overall, deontic *must* is substantially shorter than epistemic *must*, by raw numbers that is a difference of almost 50ms. Epistemic *must* is also a bit less variable (lower standard deviation).

```{r class.source = "fold-show"}
must |> 
  group_by(meaning) |> 
  summarise(mean = mean(dur), sd = sd(dur))
```

This graph illustrates this result:

```{r}
ggplot(must, aes(meaning, dur * 1000, fill = meaning)) +
  geom_violin(color = NA) +
  geom_boxplot(width = .2, fill = "grey90", notch = TRUE) +
  labs(
    title = "Duration of *must* by meaning:",
    subtitle = "Deontic *must* is substantially shorter than epistemic *must*",
    y = "Duration (ms)", x = NULL
    ) +
  scale_fill_manual(values = c(PB, PG)) +
  theme(
    legend.position = "none",
    )
```

### Duration & speech rate

Of course the duration of a word heavily depends on a variety of factors. First and most obviously, if a word occurs in a context of rapid speed, then *must* will also be spoken faster. Recall that we measured "speech rate" as number of syllables per second in the context span of 20 words to the left and right of *must*.

The effect can be clearly seen in this graph:

```{r}
ggplot(must,
       aes(sr, dur * 1000)) +
  geom_jitter(size = 2, alpha = 0.2, color = PB) +
  geom_smooth(se = FALSE, color = PG) +
  labs(title = "Duration by speech rate",
       subtitle = "Faster speech is associated with shorter *must* duration",
       x = "Speech rate (syllables/seconds)",
       y = "Duration (ms)") +
  scale_color_manual(values = c(PB, PG))
```

### Duration & emphasis

Word duration can also be affected by whether a word is particularly emphasized - if you put emphasis in your speech, it'll likely become more careful and thus of longer duration.

The descriptive statistic here shows that deontic *must* is not only more frequent, but also relatively more often with particular emphasis. Both properties, especially the frequency of occurrence, are *likely* due to the nature of the source data: the data is from US network television, which is more formal. 

```{r}
must_tab <- must |> 
  group_by(emphasis, meaning) |> 
  count() |> 
  # get percentages
  group_by(meaning) |> 
  mutate(perc = n / sum(n))
  
ggplot(must_tab, aes(meaning, n, group = emphasis, fill = emphasis, label = perc)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label=sprintf("%1.1f%%", perc*100)), size = 3, position = position_stack(vjust = 0.5), color = "white", family = "Goldman Sans Condensed") + 
  labs(
    title = "Meaning and emphasis",
    subtitle = "Deontic *must* more frequent and proportionally more often emphasized",
    y = "Occurrences", x = NULL
    ) +
  scale_fill_manual(values = c(PB, PG))
```


The effect of emphasis on duration can clearly be seen in this violin plot: *must* uses which are emphasized (green) are overall longer than those who are not (blue). This holds for both *deotic* and *epistemic* uses:

```{r}
ggplot(must, aes(meaning, dur * 1000, fill = emphasis)) +
  geom_violinhalf(
    data = must |> filter(emphasis == "yes"),
    color = NA
    ) +
  geom_violinhalf(
    data = must |> filter(emphasis == "no"),
    color = NA,
    flip = TRUE
    ) +
  labs(
    title = "Duration by meaning and emphasis",
    subtitle = "Emphasis leads to longer duration",
    y = "Duration (ms)", x = NULL
    ) +
  scale_fill_manual(values = c(PB, PG))
```

### Duration, meaning & speech rate

The combination of these factors can also be visualized as follows:

* deontic *must* (left) is generally longer that epistemic *must* (right) - dots cluster higher on the left
* faster-paced contexts are characterized by shorter word duration: negative correlation left to right
* emphasized uses (green) are generally longer than non-emphasized ones (blue)

```{r}
ggplot(must,
       aes(sr, dur * 1000, group = emphasis, color = emphasis)) +
  geom_jitter(size = 2, alpha = 0.3) +
  geom_smooth(se = FALSE) +
  labs(title = "Duration by speech rate and emphasis",
       subtitle = "Faster speech leads to shorter *must* duration",
       x = "Speech rate (syllables/seconds)",
       y = "Duration (ms)") +
  scale_color_manual(values = c(PB, PG)) +
  facet_wrap(~meaning)

```

### ...and transitional probability?

If the word that follows *must* occurs often in that position, we also see an effect - greater probability leads to short *must* duration:

```{r}
must |> 
  # first filter the 'must + R1' combinations where no transitional probability exists:
  filter(!is.na(m_r1_tp_fw)) |> 
  ggplot(aes(log(m_r1_tp_fw), dur * 1000, group = emphasis, color = emphasis)) +
  geom_jitter(size = 2, alpha = 0.3) +
  geom_smooth(se = FALSE) +
  labs(title = "Duration by transitional probability",
       subtitle = "Greater expectation leads to shorter *must* duration",
       x = "Transitional probability (log) between 'must' and the first word on the right",
       y = "Duration (ms)") +
  scale_color_manual(values = c(PB, PG))

```

## Regression model

In situations with multiple influencing factors, we can or should use a regression model to test whether the correlation between an outcome (here: duration) and a factor of interest (here: meaning) is independent of all the other variables that also show the same effect. In other words, we need to 'control' for the other factors before drawing conclusions.

We can fit a linear model. The picture is overall quite more complicated and the data a little stubborn (as is often the case with language data...), but for illustration purposes, it will suffice for now - and the overal conclusions remain valid even if we throw more robust statistical modelling at that data.

```{r}

must_lm <- must |> 
  rename(duration = dur, speech_rate = sr, trans_prob = m_r1_tp_fw) |> 
  select(duration, meaning, emphasis, speech_rate, trans_prob)

lm(log(duration) ~ meaning + speech_rate + emphasis + trans_prob, data = must_lm) |> 
  #lm(log(dur) ~ meaning + sr + emphasis + log(m_r1_tp_fw), data = must) %>%
  broom::tidy() %>%
  kable(digits = 3, caption = "Outcome for predictors of simple linear predicting must duration")

```

We should be careful to read too much from the data, as mentioned above. But what we *can* read from the `estimate` column is that all predictors with a positive estimate, or "coefficient", lead to *longer* word duration (`emphasis`) and those with a negative coefficient lead to *shorter* word duration (`meaning` if epistemic, `speech_rate` and `trans_prob`).

We must not read much into numerical differences between the estimates as the predictors are on different scales. We would need to transform the data accordingly, but we'll leave that for another day.

## Conclusions

Thus, from this model and the data we currently have, we can conclude that the different meanings of *must* indeed show substantial phonetic differences:

* Deontic *must* is substantially longer
* Deontic *must* is also subject to more emphasis (in this data)
* Meaning is a significant factor for word duration

I am no phonetician, but I have had chats to colleagues that the raw difference of about 50ms is *worlds*. From a word production perspective, this could point to speakers perceiving them as different lexical words. And, a working hypothesis going forward would be that hearers use that phonetic information when needing to find the correct meaning or when ambiguity arises.

## References
Gahl, Susanne. 2008. *Time* and *thyme* are not homophones: The effect of lemma frequency on word durations in spontaneous speech, *Language* 84: 474-496. [10.1353/lan.0.0035](https://doi.org/10.1353/lan.0.0035)